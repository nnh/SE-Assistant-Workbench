# プロジェクト名

Googleフォーム送信をトリガーとしてTeamsのチャットに情報を送信するためのスクリプトです。  
スプレッドシートにバインドされたGASでのみ動作します。

## Teamsのチャットの事前設定

1. 送信したいチャットの`...`からワークフローを選択してください。
1. 「Webhook要求を受信したらチャットに投稿する」を選択してください。
1. 接続を選択し「次へ」「ワークフローを追加する」を選択するとURLが出力されます。コピーしてメモ帳などに貼り付けて保存しておいてください。

## 使い方

1. Googleフォームの回答のスプレッドシートを開き、メニューの「拡張機能」から「App Script」を開いてください。
1. dist/index.jsを全てコピーし、コード.gsに貼り付けて保存してください。
1. 「プロジェクトの設定」を開き、「スクリプトプロパティ」の「スクリプトプロパティを追加」をクリックして下記の値を入力し、保存してください。

- プロパティ：`WEBHOOK_URL`
- 値：`Teamsのチャットの事前設定で保存したURL`

1. 「トリガー」を開き、「トリガーを追加」をクリックして「イベントの種類を選択」で「フォーム送信時」を選択し、保存してください。
1. 「エディタ」を開き、「実行」をクリックしてください。アクセス許可を求めるポップアップが表示されるので、許可して進んでください。実行時にエラーが出たら無視してください。処理が終わったらスプレッドシートを閉じてください。

## 開発者向け情報

```bash
git clone git@github.com:nnh/SE-Assistant-Workbench.git
cd 2025/issue126
```

node.jsのインストールが必要です。  
リポジトリをクローンし、該当のフォルダ配下で`npx @google/aside init`を実行してください。  
`.clasp-dev.json`にスプレッドシート情報等を記載し、`npm run deploy`を実行するとそのスプレッドシートにスクリプトがpushされます。

## ライセンス

このプロジェクトはMITライセンスです。
